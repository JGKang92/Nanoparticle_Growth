function [Nf, Ne] = Calculate_Nf_Ne(n, si)
    if ~isempty(find(si<0,1))
        Nf = n.^(2/3);
        Ne = n.^(1/3);
    else
        % Calculate number of face/edge atom for general TOh
        s = (12 - 36.*si + 9.*si.^2 + (3.^(2/3).*(304 - 768.*si + 576.*si.^2 - 156.*si.^3 + 9.*si.^4))./ ...
        (-8640 + 13824.*n + 34560.*si - 62208.*n.*si - 53568.*si.^2 + 101088.*n.*si.^2 + 42552.*si.^3 - 75168.*n.*si.^3 - 19116.*si.^4 + 29160.*n.*si.^4 + 4698.*si.^5 - 5832.*n.*si.^5 - 486.*si.^6 + ...
        486.*n.*si.^6 + sqrt(3).*sqrt(-(304 - 768.*si + 576.*si.^2 - 156.*si.^3 + 9.*si.^4).^3 + ...
        972.*(32.*(-5 + 8.*n) - 128.*(-5 + 9.*n).*si + 16.*(-62 + 117.*n).*si.^2 + (788 - 1392.*n).*si.^3 + 6.*(-59 + 90.*n).*si.^4 + (87 - 108.*n).*si.^5 + 9.*(-1 + n).*si.^6).^2)).^ ...
        (1/3) + 3.^(1/3).*(-8640 + 13824.*n + 34560.*si - 62208.*n.*si - 53568.*si.^2 + 101088.*n.*si.^2 + 42552.*si.^3 - 75168.*n.*si.^3 - 19116.*si.^4 + 29160.*n.*si.^4 + ...
        4698.*si.^5 - 5832.*n.*si.^5 - 486.*si.^6 + 486.*n.*si.^6 + sqrt(3).* ...
        sqrt(-(304 - 768.*si + 576.*si.^2 - 156.*si.^3 + 9.*si.^4).^3 + 972.* ...
        (32.*(-5 + 8.*n) - 128.*(-5 + 9.*n).*si + 16.*(-62 + 117.*n).*si.^2 + (788 - 1392.*n).*si.^3 + 6.*(-59 + 90.*n).*si.^4 + (87 - 108.*n).*si.^5 + 9.*(-1 + n).*si.^6).^2)).^(1/3) ...
        )./(3.*(-16 + 36.*si - 18.*si.^2 + 3.*si.^3));
        unitstep1 = s>=1;
        unitstep2 = s>=2;
        unitstep3 = (2 - 2./s - si) >= 0;
        Ne = 12.*(s - 1).*double(unitstep1); %(S10-5)
        Nf = (4.*(s-1).*(s-2)-3.*(2.*s-si.*s-2).*(2.*s-si.*s)+6.*(s - 1 - s.*si./2).^2.*double(unitstep3)).*double(unitstep2); %(S10-12)
    end
end
